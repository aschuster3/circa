{% load static %}
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{% static 'css/bootstrap.min.css'%}" rel="stylesheet" media="screen">
    <title>
        Circa - Buy and Sell Locally
    </title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script text="text/javascript">
        function calc_time_left(end, display) {
            var time_left = end - (Date.now() / 1000.0);
            var displayText;

            if(time_left > 0) {
                // We only care about hours left
                time_left = time_left / 3600.0;
                if(time_left < 1){
                    //less than an hour left, display minutes
                    time_left = time_left * 60.0;
                    time_left = Math.floor(time_left);
                    displayText = time_left + " minutes";
                    }
                else {
                    time_left = Math.floor(time_left);
                    displayText = time_left + " hours";
                    }
            } else {
                displayText = "None";
            }
            display.textContent = displayText
        }
        window.onload = function () {
        var display;
        {% for item in items %}
            display = document.querySelector("#time_left{{ item.auction.id }}");
            calc_time_left({{ item.auction.end_date|date:"U" }}, display);
        {% endfor %}
    };
    </script>
</head>
<body>
  <nav class="navbar navbar-inverse">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Circa<sup>beta</sup></a>
        </div>
        <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="/sell/">Sell</a></li>
                    <li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
                    <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
                </ul>
        </div>
    </div>
</nav>

    {%  if items %}
    <div class = "container">
        <div class ="list-group">
            {% for item in items %}
                    <div class="panel panel-info">
                        <div class = "panel-heading">
                            <h3 class = "panel-title"><a href="/auction/{{item.auction.id}}">{{item.title}}</a></h3>
                        </div>
                        <div class = "panel-body">
                            <div class = "panel-info">
                                <div class="row">
                                    <div class="col-xs-7 col-md-2">
                                        <a href="#" class="thumbnail">
                                             <img src="http://placehold.it/100x100" alt="...">
                                         </a>
                                     </div>
                                     <div class="col-xs-0 col-md-7">
                                       <span class = "hidden-xs"> {{ item.description }}</span>
                                      </div>
                                      <div class ="col-xs-5 col-md-3">
                                       Current Bid: <strong>${{ item.auction.current_bid }}</strong>
                                       <br>
                                       Buy now for: <strong>${{ item.auction.buy_now_price }}</strong>
                                      <br>
                                       Time Left: <strong><span id="time_left{{ item.auction.id }}"></span></strong>
                                       </div>

                                </div>
                            </div>
                        </div>


                    </div>

            {% endfor %}
        </div>
        {% else %}
            <h2>This is awkward...there's nothing for sale!</h2>
    {% endif %}
    </div>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>

</body>
</html>